#!/bin/bash
# Configures nginx to listen on port 80 of all active IPv4 IPs

# Backup the original configuration
cp /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.bak

# Update the default configuration
sed -i 's/listen\s*[0-9]\+/listen 80/g' /etc/nginx/conf.d/default.conf

# Test the configuration
nginx -t

# If the test is successful, reload Nginx
if [ $? -eq 0 ]; then
    nginx -s reload
    echo "Nginx configuration updated and reloaded."
else
    echo "Nginx configuration test failed. Please check the configuration manually."
fi
